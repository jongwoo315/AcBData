---
layout: post
title: Python - 17/02/28 (1)
category: acorn수업
---


```python
import pandas as pd
import numpy as np
```


```python
ages = [20, 22, 25, 27, 21, 24, 37, 31, 61, 45, 41, 32]
bins = [18, 25, 35, 60, 100]
cats = pd.cut(ages, bins)
cats
```




    [(18, 25], (18, 25], (18, 25], (25, 35], (18, 25], ..., (25, 35], (60, 100], (35, 60], (35, 60], (25, 35]]
    Length: 12
    Categories (4, object): [(18, 25] < (25, 35] < (35, 60] < (60, 100]]


<br>

```python
cats.codes
```




    array([0, 0, 0, 1, 0, 0, 2, 1, 3, 2, 2, 1], dtype=int8)


<br>

```python
cats.categories
```




    Index([u'(18, 25]', u'(25, 35]', u'(35, 60]', u'(60, 100]'], dtype='object')


<br>

```python
pd.value_counts(cats)
```




    (18, 25]     5
    (35, 60]     3
    (25, 35]     3
    (60, 100]    1
    dtype: int64


<br>

```python
pd.cut(ages, [18, 26, 36, 61, 100], right = False)
```




    [[18, 26), [18, 26), [18, 26), [26, 36), [18, 26), ..., [26, 36), [61, 100), [36, 61), [36, 61), [26, 36)]
    Length: 12
    Categories (4, object): [[18, 26) < [26, 36) < [36, 61) < [61, 100)]


<br>

```python
# 라벨 붙여서 범위를 대체하기
group_names = ['youth', 'youthadult', 'middleaged', 'senior']
pd.cut(ages, bins, labels = group_names)
```




    [youth, youth, youth, youthadult, youth, ..., youthadult, senior, middleaged, middleaged, youthadult]
    Length: 12
    Categories (4, object): [youth < youthadult < middleaged < senior]


<br>

```python
# 소수점 아래 2개의 숫자 표시(두자리까지 표시가 아님)
data = np.random.rand(20)
pd.cut(data, 4, precision = 2)
```




    [(0.73, 0.97], (0.49, 0.73], (0.73, 0.97], (0.49, 0.73], (0.0098, 0.25], ..., (0.73, 0.97], (0.25, 0.49], (0.25, 0.49], (0.0098, 0.25], (0.25, 0.49]]
    Length: 20
    Categories (4, object): [(0.0098, 0.25] < (0.25, 0.49] < (0.49, 0.73] < (0.73, 0.97]]

<br>

# qcut


```python
data1 = np.random.randn(1000)
cats1 = pd.qcut(data1, 4)
cats1
```




    [[-3.537, -0.635], [-3.537, -0.635], (-0.0277, 0.673], [-3.537, -0.635], (-0.0277, 0.673], ..., (-0.0277, 0.673], (-0.0277, 0.673], [-3.537, -0.635], (-0.635, -0.0277], (-0.0277, 0.673]]
    Length: 1000
    Categories (4, object): [[-3.537, -0.635] < (-0.635, -0.0277] < (-0.0277, 0.673] < (0.673, 3.364]]


<br>

```python
pd.value_counts(cats1)
```




    (0.673, 3.364]       250
    (-0.0277, 0.673]     250
    (-0.635, -0.0277]    250
    [-3.537, -0.635]     250
    dtype: int64


<br>

```python
# qcut(data1, 4)와 동일
pd.qcut(data1, [0, .25, .5, .75, 1])
```




    [[-3.537, -0.635], [-3.537, -0.635], (-0.0277, 0.673], [-3.537, -0.635], (-0.0277, 0.673], ..., (-0.0277, 0.673], (-0.0277, 0.673], [-3.537, -0.635], (-0.635, -0.0277], (-0.0277, 0.673]]
    Length: 1000
    Categories (4, object): [[-3.537, -0.635] < (-0.635, -0.0277] < (-0.0277, 0.673] < (0.673, 3.364]]


<br>

```python
pd.qcut(data1, [0, 0.1, 0.5, 0.9, 1])
```




    [(-0.00944, 1.371], (1.371, 2.911], (-0.00944, 1.371], (-0.00944, 1.371], (-1.249, -0.00944], ..., (-1.249, -0.00944], (-0.00944, 1.371], (-1.249, -0.00944], (-1.249, -0.00944], (-0.00944, 1.371]]
    Length: 1000
    Categories (4, object): [[-3.137, -1.249] < (-1.249, -0.00944] < (-0.00944, 1.371] < (1.371, 2.911]]

<br>

# pima


```python
pima = pd.read_csv('pima.csv', index_col = 0)
pima.describe()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>npreg</th>
      <th>glu</th>
      <th>bp</th>
      <th>skin</th>
      <th>bmi</th>
      <th>ped</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>332.000000</td>
      <td>332.000000</td>
      <td>332.000000</td>
      <td>332.000000</td>
      <td>332.000000</td>
      <td>332.000000</td>
      <td>332.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.484940</td>
      <td>119.259036</td>
      <td>71.653614</td>
      <td>29.162651</td>
      <td>33.239759</td>
      <td>0.528389</td>
      <td>31.316265</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.283634</td>
      <td>30.501138</td>
      <td>12.799307</td>
      <td>9.748068</td>
      <td>7.282901</td>
      <td>0.363278</td>
      <td>10.636225</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>65.000000</td>
      <td>24.000000</td>
      <td>7.000000</td>
      <td>19.400000</td>
      <td>0.085000</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>96.000000</td>
      <td>64.000000</td>
      <td>22.000000</td>
      <td>28.175000</td>
      <td>0.266000</td>
      <td>23.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>112.000000</td>
      <td>72.000000</td>
      <td>29.000000</td>
      <td>32.900000</td>
      <td>0.440000</td>
      <td>27.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.000000</td>
      <td>136.250000</td>
      <td>80.000000</td>
      <td>36.000000</td>
      <td>37.200000</td>
      <td>0.679250</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>17.000000</td>
      <td>197.000000</td>
      <td>110.000000</td>
      <td>63.000000</td>
      <td>67.100000</td>
      <td>2.420000</td>
      <td>81.000000</td>
    </tr>
  </tbody>
</table>
</div>

<br>


```python
pima.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>npreg</th>
      <th>glu</th>
      <th>bp</th>
      <th>skin</th>
      <th>bmi</th>
      <th>ped</th>
      <th>age</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>78</td>
      <td>50</td>
      <td>32</td>
      <td>31.0</td>
      <td>0.248</td>
      <td>26</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>197</td>
      <td>70</td>
      <td>45</td>
      <td>30.5</td>
      <td>0.158</td>
      <td>53</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
print pima.count() # 행 숫자 세기
```

    npreg    332
    glu      332
    bp       332
    skin     332
    bmi      332
    ped      332
    age      332
    type     332
    dtype: int64

<br>

```python
print pima.mean()
print pima.median()
```

    npreg      3.484940
    glu      119.259036
    bp        71.653614
    skin      29.162651
    bmi       33.239759
    ped        0.528389
    age       31.316265
    dtype: float64
    npreg      2.00
    glu      112.00
    bp        72.00
    skin      29.00
    bmi       32.90
    ped        0.44
    age       27.00
    dtype: float64

<br>

```python
print pima.quantile()
print pima.std()
'''pima.var()
pima.min()'''
print pima.max()
```

    npreg      2.00
    glu      112.00
    bp        72.00
    skin      29.00
    bmi       32.90
    ped        0.44
    age       27.00
    dtype: float64
    npreg     3.283634
    glu      30.501138
    bp       12.799307
    skin      9.748068
    bmi       7.282901
    ped       0.363278
    age      10.636225
    dtype: float64
    npreg      17
    glu       197
    bp        110
    skin       63
    bmi      67.1
    ped      2.42
    age        81
    type      Yes
    dtype: object

<br>

```python
# axis = 1 / 가로로 계산(열을 따라 계산)
pima.mean(axis = 1).head()
```




    1    49.318143
    2    34.135857
    3    32.609571
    4    31.464000
    5    56.808286
    dtype: float64


<br>

```python
# 행 검색
print pima[0:2]
#pima[-3:]
```

       npreg  glu  bp  skin   bmi    ped  age type
    1      6  148  72    35  33.6  0.627   50  Yes
    2      1   85  66    29  26.6  0.351   31   No





    "pima[-3:]\npima['bmi']\ntype(pima['bmi'])\npima.shape\npima[pima['bmi'] > 30].shape"


<br>

```python
# 열 검색
pima['bmi']
```

    1      33.6
    2      26.6
    3      28.1
    4      31.0
    5      30.5
    6      25.8
    7      45.8
    8      43.3
    9      39.3
    10     29.0
    11     23.2
    12     36.0
    13     24.8
    14     27.6
    15     24.0
    16     32.9
    17     38.2
    18     37.1
    19     34.0
    20     22.7
    21     45.4
    22     42.0
    23     28.0
    24     19.4
    25     24.2
    26     24.4
    27     34.7
    28     23.0
    29     41.5
    30     29.0
           ...
    303    41.2
    304    26.4
    305    33.9
    306    33.8
    307    23.1
    308    35.5
    309    39.1
    310    36.1
    311    32.4
    312    44.5
    313    29.0
    314    27.4
    315    32.0
    316    36.6
    317    42.3
    318    30.8
    319    28.5
    320    40.6
    321    30.0
    322    49.3
    323    36.4
    324    39.0
    325    26.0
    326    43.3
    327    36.5
    328    28.4
    329    44.0
    330    32.9
    331    26.2
    332    30.4
    Name: bmi, dtype: float64





    (210, 8)

<br>


```python
isinstance(pima.bmi, pd.Series)
```




    True


<br>

```python
type(pima['bmi'])
```




    pandas.core.series.Series


<br>

```python
pima.shape # (332, 8) 행:332개, 열:8개
pima[pima['bmi'] > 30].shape
```




    (210, 8)


<br>

```python
import pylab
import matplotlib.pyplot as plt
```

<br>

```python
%matplotlib inline
pima.bmi.describe()
```




    count    332.000000
    mean      33.239759
    std        7.282901
    min       19.400000
    25%       28.175000
    50%       32.900000
    75%       37.200000
    max       67.100000
    Name: bmi, dtype: float64

<br>


```python
pima.bmi.plot()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7fae2d08ab50>




![png]({{ site.baseurl }}/images/python_acorn/2017-06-10-acorn79_1_170228_files/2017-06-10-acorn79_1_170228_27_1.png)

<br>

```python
pima['bmi'].hist()
plt.show()
```


![png]({{ site.baseurl }}/images/python_acorn/2017-06-10-acorn79_1_170228_files/2017-06-10-acorn79_1_170228_28_0.png)

<br>

```python
pima['bmi'].plot(kind = 'kde') # kernel density estimation plot
plt.show()
```


![png]({{ site.baseurl }}/images/python_acorn/2017-06-10-acorn79_1_170228_files/2017-06-10-acorn79_1_170228_29_0.png)

<br>

```python
# pima dataframe의 속성 'type'을 기준으로 group화 시키고, yes, no에 대한 평균을 계산
pima.groupby('type').mean()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>npreg</th>
      <th>glu</th>
      <th>bp</th>
      <th>skin</th>
      <th>bmi</th>
      <th>ped</th>
      <th>age</th>
    </tr>
    <tr>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>No</th>
      <td>2.932735</td>
      <td>108.188341</td>
      <td>70.130045</td>
      <td>27.340807</td>
      <td>31.639910</td>
      <td>0.464565</td>
      <td>29.215247</td>
    </tr>
    <tr>
      <th>Yes</th>
      <td>4.614679</td>
      <td>141.908257</td>
      <td>74.770642</td>
      <td>32.889908</td>
      <td>36.512844</td>
      <td>0.658963</td>
      <td>35.614679</td>
    </tr>
  </tbody>
</table>
</div>

<br>

# .ix


```python
df = pd.DataFrame(np.random.rand(10, 5), columns = ['A', 'B', 'C', 'D', 'E'])
df
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.128372</td>
      <td>0.343289</td>
      <td>0.404325</td>
      <td>0.068510</td>
      <td>0.593595</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.611134</td>
      <td>0.847905</td>
      <td>0.681446</td>
      <td>0.235749</td>
      <td>0.795597</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.435308</td>
      <td>0.785805</td>
      <td>0.635689</td>
      <td>0.319548</td>
      <td>0.028547</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.208690</td>
      <td>0.113016</td>
      <td>0.211885</td>
      <td>0.386081</td>
      <td>0.467654</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.125241</td>
      <td>0.831596</td>
      <td>0.737896</td>
      <td>0.911937</td>
      <td>0.826579</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.622118</td>
      <td>0.116611</td>
      <td>0.650271</td>
      <td>0.362003</td>
      <td>0.381360</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.498316</td>
      <td>0.352616</td>
      <td>0.321902</td>
      <td>0.426162</td>
      <td>0.939045</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.944195</td>
      <td>0.894185</td>
      <td>0.802503</td>
      <td>0.870289</td>
      <td>0.977573</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.366122</td>
      <td>0.261100</td>
      <td>0.439812</td>
      <td>0.007567</td>
      <td>0.264296</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.067096</td>
      <td>0.562827</td>
      <td>0.530162</td>
      <td>0.126592</td>
      <td>0.351396</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
# .ix로 행과 열을 모두 검색할 수 있다. ix[행번호, 열번호]
df.ix[0, 1:2]
```




    B    0.343289
    Name: 0, dtype: float64


<br>

```python
# df의 첫번째 행의 모든 열 중에서 0.5보다 작은 것들을 boolean으로 반환
df.ix[0, :] < 0.5
```




    A     True
    B     True
    C     True
    D     True
    E    False
    Name: 0, dtype: bool


<br>

```python
# 첫번째 행의 값이 0.5보다 작은 열들을 모두 출력
df.ix[:, df.ix[0, :] < 0.5]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.128372</td>
      <td>0.343289</td>
      <td>0.404325</td>
      <td>0.068510</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.611134</td>
      <td>0.847905</td>
      <td>0.681446</td>
      <td>0.235749</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.435308</td>
      <td>0.785805</td>
      <td>0.635689</td>
      <td>0.319548</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.208690</td>
      <td>0.113016</td>
      <td>0.211885</td>
      <td>0.386081</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.125241</td>
      <td>0.831596</td>
      <td>0.737896</td>
      <td>0.911937</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.622118</td>
      <td>0.116611</td>
      <td>0.650271</td>
      <td>0.362003</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.498316</td>
      <td>0.352616</td>
      <td>0.321902</td>
      <td>0.426162</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.944195</td>
      <td>0.894185</td>
      <td>0.802503</td>
      <td>0.870289</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.366122</td>
      <td>0.261100</td>
      <td>0.439812</td>
      <td>0.007567</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.067096</td>
      <td>0.562827</td>
      <td>0.530162</td>
      <td>0.126592</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
grouped_by_type = pima.groupby('type')
grouped_by_type.agg([np.mean, np.std])
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">npreg</th>
      <th colspan="2" halign="left">glu</th>
      <th colspan="2" halign="left">bp</th>
      <th colspan="2" halign="left">skin</th>
      <th colspan="2" halign="left">bmi</th>
      <th colspan="2" halign="left">ped</th>
      <th colspan="2" halign="left">age</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>No</th>
      <td>2.932735</td>
      <td>2.781852</td>
      <td>108.188341</td>
      <td>22.645932</td>
      <td>70.130045</td>
      <td>12.381916</td>
      <td>27.340807</td>
      <td>9.567705</td>
      <td>31.639910</td>
      <td>6.648015</td>
      <td>0.464565</td>
      <td>0.315157</td>
      <td>29.215247</td>
      <td>10.131493</td>
    </tr>
    <tr>
      <th>Yes</th>
      <td>4.614679</td>
      <td>3.901349</td>
      <td>141.908257</td>
      <td>32.035727</td>
      <td>74.770642</td>
      <td>13.128026</td>
      <td>32.889908</td>
      <td>9.065951</td>
      <td>36.512844</td>
      <td>7.457548</td>
      <td>0.658963</td>
      <td>0.417949</td>
      <td>35.614679</td>
      <td>10.390441</td>
    </tr>
  </tbody>
</table>
</div>

<br>

# groupby


```python
df = pd.DataFrame({'key1':['a', 'a', 'b', 'b', 'a'], 'key2':['one', 'two', 'one', 'two', 'one'],
                  'data1':np.random.randn(5),
                  'data2':np.random.randn(5)})
df
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
      <th>key1</th>
      <th>key2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.817329</td>
      <td>-0.016933</td>
      <td>a</td>
      <td>one</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.533942</td>
      <td>-0.639533</td>
      <td>a</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.002484</td>
      <td>1.648414</td>
      <td>b</td>
      <td>one</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.543996</td>
      <td>-0.341813</td>
      <td>b</td>
      <td>two</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.197518</td>
      <td>-0.716697</td>
      <td>a</td>
      <td>one</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
grouped1 = df['data1'].groupby(df['key1'])
grouped1.mean()
```




    key1
    a    0.717917
    b   -0.229244
    Name: data1, dtype: float64


<br>

```python
grouped2 = df.groupby(df['key1'])
grouped2.agg([np.mean, np.std])
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">data1</th>
      <th colspan="2" halign="left">data2</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>key1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.717917</td>
      <td>1.019945</td>
      <td>-0.457721</td>
      <td>0.383679</td>
    </tr>
    <tr>
      <th>b</th>
      <td>-0.229244</td>
      <td>1.093526</td>
      <td>0.653301</td>
      <td>1.407303</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
grouped3 = df['data1'].groupby([df['key1'], df['key2']])
group3_mean = grouped3.mean()
group3_mean
```




    key1  key2
    a     one     0.809905
          two     0.533942
    b     one    -1.002484
          two     0.543996
    Name: data1, dtype: float64


<br>

```python
type(group3_mean)
```




    pandas.core.series.Series


<br>

```python
# unstack을 하면 기본적으로 index의 가장 최하층이 열로 이동한다
group3_mean.unstack()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>key2</th>
      <th>one</th>
      <th>two</th>
    </tr>
    <tr>
      <th>key1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.809905</td>
      <td>0.533942</td>
    </tr>
    <tr>
      <th>b</th>
      <td>-1.002484</td>
      <td>0.543996</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
states = np.array(['Ohio', 'California', 'California', 'Ohio', 'Ohio'])
years = np.array([2005, 2005, 2006, 2005, 2006])
df['data1'].groupby([states, years]).mean()
```




    California  2005    0.533942
                2006   -1.002484
    Ohio        2005    1.180662
                2006   -0.197518
    Name: data1, dtype: float64


<br>

```python
df.groupby('key1').mean()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.717917</td>
      <td>-0.457721</td>
    </tr>
    <tr>
      <th>b</th>
      <td>-0.229244</td>
      <td>0.653301</td>
    </tr>
  </tbody>
</table>
</div>

<br>


```python
df.groupby(['key1', 'key2']).mean()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key1</th>
      <th>key2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>one</th>
      <td>0.809905</td>
      <td>-0.366815</td>
    </tr>
    <tr>
      <th>two</th>
      <td>0.533942</td>
      <td>-0.639533</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>one</th>
      <td>-1.002484</td>
      <td>1.648414</td>
    </tr>
    <tr>
      <th>two</th>
      <td>0.543996</td>
      <td>-0.341813</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
df.groupby(['key1', 'key2']).size()
```




    key1  key2
    a     one     2
          two     1
    b     one     1
          two     1
    dtype: int64



- apply (row나 column별로 적용) dataframe
- applymap (각각의 원소별로) dataframe
- map Series가 사용됨

<br>

# groupby 2


```python
def peak_to_peak(arr):
    return arr.max() - arr.min()
```

<br>

```python
df = pd.DataFrame({'key1':['a', 'a', 'b', 'b', 'a'], 'key2':['one', 'two', 'one', 'two', 'one'],
                  'data1':np.random.randn(5),
                  'data2':np.random.randn(5)})
df
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
      <th>key1</th>
      <th>key2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.914833</td>
      <td>-1.424554</td>
      <td>a</td>
      <td>one</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.738513</td>
      <td>0.191174</td>
      <td>a</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.210601</td>
      <td>-0.978303</td>
      <td>b</td>
      <td>one</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.136539</td>
      <td>0.967734</td>
      <td>b</td>
      <td>two</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.259087</td>
      <td>-0.877878</td>
      <td>a</td>
      <td>one</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
people = pd.DataFrame(np.random.randn(5, 5),
                     columns = ['a', 'b', 'c', 'd', 'e'],
                     index = ['Joe', 'Steve', 'Wes', 'Jim', 'Travis'])
```

<br>

```python
people.ix[2:3, ['b', 'c']] = np.nan
people
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Joe</th>
      <td>-0.061359</td>
      <td>-0.753810</td>
      <td>-0.227942</td>
      <td>-0.013655</td>
      <td>1.530129</td>
    </tr>
    <tr>
      <th>Steve</th>
      <td>-1.296761</td>
      <td>-0.160817</td>
      <td>-0.520816</td>
      <td>-1.900961</td>
      <td>-1.689923</td>
    </tr>
    <tr>
      <th>Wes</th>
      <td>0.359652</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.192152</td>
      <td>-0.377395</td>
    </tr>
    <tr>
      <th>Jim</th>
      <td>-0.138069</td>
      <td>-1.135298</td>
      <td>1.264733</td>
      <td>1.348008</td>
      <td>-0.915452</td>
    </tr>
    <tr>
      <th>Travis</th>
      <td>-0.074430</td>
      <td>1.571596</td>
      <td>1.608429</td>
      <td>0.432183</td>
      <td>-0.376793</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
k1_means = df.groupby('key1').mean().add_prefix('mean_')
k1_means                                        
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_data1</th>
      <th>mean_data2</th>
    </tr>
    <tr>
      <th>key1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.478469</td>
      <td>-0.703753</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.173570</td>
      <td>-0.005284</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
merg = pd.merge(df, k1_means, left_on = 'key1', right_index = True)
merg
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
      <th>key1</th>
      <th>key2</th>
      <th>mean_data1</th>
      <th>mean_data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.914833</td>
      <td>-1.424554</td>
      <td>a</td>
      <td>one</td>
      <td>0.478469</td>
      <td>-0.703753</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.738513</td>
      <td>0.191174</td>
      <td>a</td>
      <td>two</td>
      <td>0.478469</td>
      <td>-0.703753</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.259087</td>
      <td>-0.877878</td>
      <td>a</td>
      <td>one</td>
      <td>0.478469</td>
      <td>-0.703753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.210601</td>
      <td>-0.978303</td>
      <td>b</td>
      <td>one</td>
      <td>0.173570</td>
      <td>-0.005284</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.136539</td>
      <td>0.967734</td>
      <td>b</td>
      <td>two</td>
      <td>0.173570</td>
      <td>-0.005284</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
pd.concat([df, k1_means])
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
      <th>key1</th>
      <th>key2</th>
      <th>mean_data1</th>
      <th>mean_data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.914833</td>
      <td>-1.424554</td>
      <td>a</td>
      <td>one</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.738513</td>
      <td>0.191174</td>
      <td>a</td>
      <td>two</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.210601</td>
      <td>-0.978303</td>
      <td>b</td>
      <td>one</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.136539</td>
      <td>0.967734</td>
      <td>b</td>
      <td>two</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.259087</td>
      <td>-0.877878</td>
      <td>a</td>
      <td>one</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>a</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.478469</td>
      <td>-0.703753</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.173570</td>
      <td>-0.005284</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
key = ['one', 'two', 'one', 'two', 'one']
mean_people = people.groupby(key).mean()
mean_people
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>0.764415</td>
      <td>0.100860</td>
      <td>0.515082</td>
      <td>0.101761</td>
      <td>1.097660</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.588465</td>
      <td>0.715386</td>
      <td>-0.113634</td>
      <td>-0.056784</td>
      <td>-0.344479</td>
    </tr>
  </tbody>
</table>
</div>

<br>


```python
# 매개변수 key는 index에 매칭이 된다.
# transform을 하면 'one', 'two'로 묶였던 index들이 원래 index로 바뀌지만, 값들은 np.mean을 가지게 됨
mean_people2 = people.groupby(key).transform(np.mean)
mean_people2
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Joe</th>
      <td>0.764415</td>
      <td>0.100860</td>
      <td>0.515082</td>
      <td>0.101761</td>
      <td>1.097660</td>
    </tr>
    <tr>
      <th>Steve</th>
      <td>-0.588465</td>
      <td>0.715386</td>
      <td>-0.113634</td>
      <td>-0.056784</td>
      <td>-0.344479</td>
    </tr>
    <tr>
      <th>Wes</th>
      <td>0.764415</td>
      <td>0.100860</td>
      <td>0.515082</td>
      <td>0.101761</td>
      <td>1.097660</td>
    </tr>
    <tr>
      <th>Jim</th>
      <td>-0.588465</td>
      <td>0.715386</td>
      <td>-0.113634</td>
      <td>-0.056784</td>
      <td>-0.344479</td>
    </tr>
    <tr>
      <th>Travis</th>
      <td>0.764415</td>
      <td>0.100860</td>
      <td>0.515082</td>
      <td>0.101761</td>
      <td>1.097660</td>
    </tr>
  </tbody>
</table>
</div>

<br>


```python
def demean(arr):
    return arr - arr.mean()
```

<br>

```python
demeaned = people.groupby(key).transform(demean)
demeaned
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Joe</th>
      <td>-0.465778</td>
      <td>-0.963909</td>
      <td>-1.099095</td>
      <td>1.458036</td>
      <td>-0.424150</td>
    </tr>
    <tr>
      <th>Steve</th>
      <td>0.095656</td>
      <td>-0.945064</td>
      <td>-0.836629</td>
      <td>0.026667</td>
      <td>-0.175689</td>
    </tr>
    <tr>
      <th>Wes</th>
      <td>1.841496</td>
      <td>1.535998</td>
      <td>0.955081</td>
      <td>0.315896</td>
      <td>1.692371</td>
    </tr>
    <tr>
      <th>Jim</th>
      <td>-0.095656</td>
      <td>0.945064</td>
      <td>0.836629</td>
      <td>-0.026667</td>
      <td>0.175689</td>
    </tr>
    <tr>
      <th>Travis</th>
      <td>-1.375718</td>
      <td>-0.572089</td>
      <td>0.144014</td>
      <td>-1.773932</td>
      <td>-1.268221</td>
    </tr>
  </tbody>
</table>
</div>

<br>


```python
np.round(demeaned.describe(), 2)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.17</td>
      <td>1.16</td>
      <td>0.94</td>
      <td>1.16</td>
      <td>1.09</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.38</td>
      <td>-0.96</td>
      <td>-1.10</td>
      <td>-1.77</td>
      <td>-1.27</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.47</td>
      <td>-0.95</td>
      <td>-0.84</td>
      <td>-0.03</td>
      <td>-0.42</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.10</td>
      <td>-0.57</td>
      <td>0.14</td>
      <td>0.03</td>
      <td>-0.18</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.10</td>
      <td>0.95</td>
      <td>0.84</td>
      <td>0.32</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.84</td>
      <td>1.54</td>
      <td>0.96</td>
      <td>1.46</td>
      <td>1.69</td>
    </tr>
  </tbody>
</table>
</div>

<br>

# split


```python
val = 'a, b,    guide'
val.split(',')
```




    ['a', ' b', '    guide']

<br>


```python
pieces = [x.strip() for x in val.split(',')]
pieces
```




    ['a', 'b', 'guide']

<br>


```python
first, second, third = pieces
print first+'::'+second+'::'+third
```

    a::b::guide

<br>

```python
'::'.join([first, second, third])
```




    'a::b::guide'

<br>

# datetime


```python
from datetime import datetime
```

<br>

```python
now = datetime.now()
print now, now.year, now.month, now.day
```

    2017-02-28 11:16:36.449831 2017 2 28

<br>

```python
delta = datetime(2015, 1, 7) - datetime(2010, 6, 24, 8 ,15)
print delta, delta.days, delta.seconds
```

    1657 days, 15:45:00 1657 56700

<br>

```python
from datetime import timedelta
```

<br>

```python
start = datetime(2015, 1, 7)
print start, timedelta(12)
```

    2015-01-07 00:00:00 12 days, 0:00:00

<br>

```python
print start - 2 * timedelta(12)
```

    2014-12-14 00:00:00

<br>

# 정규표현식


```python
import re
```

<br>

```python
text = '''aaa@naver.com
bbb@naver.com
ccc@naver.com
ddd@naver.com'''
```

<br>

```python
pattern = r'[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}'
regex = re.compile(pattern, flags = re.IGNORECASE)
regex.findall(text)
```




    ['aaa@naver.com', 'bbb@naver.com', 'ccc@naver.com', 'ddd@naver.com']


<br>


```python
re.split('\s+', text)
```




    ['aaa@naver.com', 'bbb@naver.com', 'ccc@naver.com', 'ddd@naver.com']


<br>

```python
regex = re.compile('\s+')
regex.split(text)
```




    ['aaa@naver.com', 'bbb@naver.com', 'ccc@naver.com', 'ddd@naver.com']


<br>

```python
regex.findall(text)
```




    ['\n', '\n', '\n']


<br>

```python
m = regex.search(text)
text[m.start():m.end()]
```




    '\n'

<br>


```python
regex.match(text)
```

<br>

```python
regex.sub('redacted', text)
```




    'aaa@naver.comredactedbbb@naver.comredactedccc@naver.comredactedddd@naver.com'


<br>

```python
pattern = r'([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.([A-Z]{2,4})'
regex = re.compile(pattern, flags = re.IGNORECASE)
m = regex.match('wes@bright.net')
regex.findall(text)
```




    [('aaa', 'naver', 'com'),
     ('bbb', 'naver', 'com'),
     ('ccc', 'naver', 'com'),
     ('ddd', 'naver', 'com')]

<br>

# date


```python
import datetime
import pandas as pd
import numpy as np
```

<br>

```python
stamp = datetime.datetime(2015, 1, 17)
str(stamp)
```




    '2015-01-17 00:00:00'


<br>

```python
stamp.strftime('%Y-%m-%d')
```




    '2015-01-17'


<br>

```python
value = '2015-01-04'
print datetime.datetime.strptime(value, '%Y-%m-%d')
```

    2015-01-04 00:00:00

<br>

```python
datestrs = ['2015-07-06', '2015-08-06']
[datetime.datetime.strptime(x, '%Y-%m-%d') for x in datestrs]
```




    [datetime.datetime(2015, 7, 6, 0, 0), datetime.datetime(2015, 8, 6, 0, 0)]


<br>

```python
df = pd.DataFrame({'year':[2015, 2016], 'month':[2, 3], 'day':[4, 5]})
pd.to_datetime(datestrs)
```




    DatetimeIndex(['2015-07-06', '2015-08-06'], dtype='datetime64[ns]', freq=None)


<br>

```python
idx = pd.to_datetime(datestrs)
idx
```




    DatetimeIndex(['2015-07-06', '2015-08-06'], dtype='datetime64[ns]', freq=None)


<br>

```python
pd.isnull(idx)
```




    array([False, False], dtype=bool)

<br>


```python
from dateutil.parser import parse
```

<br>

```python
print parse('2015-01-03')
```

    2015-01-03 00:00:00

<br>

```python
print parse('Jan 31, 1997 10:45 PM')
```

    1997-01-31 22:45:00

<br>

```python
print parse('6/12/2015', dayfirst = True)
```

    2015-12-06 00:00:00

<br>

```python
print pd.to_datetime('20150107')
```

    2015-01-07 00:00:00

<br>

```python
dates = [datetime.datetime(2015, 1, 2), datetime.datetime(2015, 1, 5),
        datetime.datetime(2015, 1, 7), datetime.datetime(2015, 1, 9),
         datetime.datetime(2015, 1, 11), datetime.datetime(2015, 1, 13)]
ts = pd.Series(np.random.randn(6), index = dates)
ts
```




    2015-01-02    0.009807
    2015-01-05    0.967336
    2015-01-07    0.817106
    2015-01-09   -1.379073
    2015-01-11    0.105543
    2015-01-13   -0.449595
    dtype: float64


<br>

```python
# 해당 날짜가 없어도 해당 날짜와 가장 가까운 다음 날짜를 선택하여 찾는다
ts['1/6/2015':'1/11/2015']
```




    2015-01-07    0.817106
    2015-01-09   -1.379073
    2015-01-11    0.105543
    dtype: float64


<br>

```python
ts[datetime.datetime(2015, 1, 7)]
```




    0.81710645466992027



<br>

```python
stamp = ts.index[2]
ts[stamp], ts['1/7/2015'], ts['20150107']
```




    (0.81710645466992027, 0.81710645466992027, 0.81710645466992027)


<br>

```python
longer_ts = pd.Series(np.random.randn(1000),
                      index = pd.date_range('1/1/2015', periods = 1000))
print longer_ts.head()
```

    2015-01-01   -0.506776
    2015-01-02   -0.299736
    2015-01-03    0.222200
    2015-01-04   -1.839930
    2015-01-05    1.210227
    Freq: D, dtype: float64

<br>

```python
longer_ts['2015/12/1'], longer_ts['2015-05-15']
```




    (0.11616959219590568, -1.7616264224953582)

<br>

# downsampling


```python
# 분단위로 보여줌
rng = pd.date_range('1/1/2014', periods = 12, freq = 'T')
ts = pd.Series(np.arange(12), index = rng)
ts
```




    2014-01-01 00:00:00     0
    2014-01-01 00:01:00     1
    2014-01-01 00:02:00     2
    2014-01-01 00:03:00     3
    2014-01-01 00:04:00     4
    2014-01-01 00:05:00     5
    2014-01-01 00:06:00     6
    2014-01-01 00:07:00     7
    2014-01-01 00:08:00     8
    2014-01-01 00:09:00     9
    2014-01-01 00:10:00    10
    2014-01-01 00:11:00    11
    Freq: T, dtype: int64



<br>

```python
# 100일치를 보여줌
rng = pd.date_range('1/1/2014', periods = 100, freq = 'D')
ts = pd.Series(np.arange(100), index = rng)
ts.head()
```




    2014-01-01    0
    2014-01-02    1
    2014-01-03    2
    2014-01-04    3
    2014-01-05    4
    Freq: D, dtype: int64


<br>

```python
ts.index
```




    DatetimeIndex(['2014-01-01', '2014-01-02', '2014-01-03', '2014-01-04',
                   '2014-01-05', '2014-01-06', '2014-01-07', '2014-01-08',
                   '2014-01-09', '2014-01-10', '2014-01-11', '2014-01-12',
                   '2014-01-13', '2014-01-14', '2014-01-15', '2014-01-16',
                   '2014-01-17', '2014-01-18', '2014-01-19', '2014-01-20',
                   '2014-01-21', '2014-01-22', '2014-01-23', '2014-01-24',
                   '2014-01-25', '2014-01-26', '2014-01-27', '2014-01-28',
                   '2014-01-29', '2014-01-30', '2014-01-31', '2014-02-01',
                   '2014-02-02', '2014-02-03', '2014-02-04', '2014-02-05',
                   '2014-02-06', '2014-02-07', '2014-02-08', '2014-02-09',
                   '2014-02-10', '2014-02-11', '2014-02-12', '2014-02-13',
                   '2014-02-14', '2014-02-15', '2014-02-16', '2014-02-17',
                   '2014-02-18', '2014-02-19', '2014-02-20', '2014-02-21',
                   '2014-02-22', '2014-02-23', '2014-02-24', '2014-02-25',
                   '2014-02-26', '2014-02-27', '2014-02-28', '2014-03-01',
                   '2014-03-02', '2014-03-03', '2014-03-04', '2014-03-05',
                   '2014-03-06', '2014-03-07', '2014-03-08', '2014-03-09',
                   '2014-03-10', '2014-03-11', '2014-03-12', '2014-03-13',
                   '2014-03-14', '2014-03-15', '2014-03-16', '2014-03-17',
                   '2014-03-18', '2014-03-19', '2014-03-20', '2014-03-21',
                   '2014-03-22', '2014-03-23', '2014-03-24', '2014-03-25',
                   '2014-03-26', '2014-03-27', '2014-03-28', '2014-03-29',
                   '2014-03-30', '2014-03-31', '2014-04-01', '2014-04-02',
                   '2014-04-03', '2014-04-04', '2014-04-05', '2014-04-06',
                   '2014-04-07', '2014-04-08', '2014-04-09', '2014-04-10'],
                  dtype='datetime64[ns]', freq='D')


<br>

```python
rng.weekday
```




    array([2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3,
           4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5,
           6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0,
           1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2, 3, 4, 5, 6, 0, 1, 2,
           3, 4, 5, 6, 0, 1, 2, 3], dtype=int32)


<br>

```python
ts.groupby(lambda x : x.month).mean()
```




    1    15.0
    2    44.5
    3    74.0
    4    94.5
    dtype: float64


<br>

```python
ts.groupby(lambda x : x.weekday).mean()
```




    0    50.5
    1    51.5
    2    49.0
    3    50.0
    4    47.5
    5    48.5
    6    49.5
    dtype: float64

<br>

# stock data


```python
close_px_all = pd.read_csv('stock_px.csv', parse_dates = True)

close_px = close_px_all[['Unnamed: 0', 'AAPL', 'MSFT', 'XOM']]
# Unnamed: 0을 index로 변경
close_px = close_px.set_index('Unnamed: 0')

# unnamed: 0 이름 변경
close_px.index.names = ['date']
close_px.head()

# 컬럼명 변경시
#close_px_all.rename(column = {'Unnamed: 0':'date'})
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>XOM</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2003-01-02 00:00:00</th>
      <td>7.40</td>
      <td>21.11</td>
      <td>29.22</td>
    </tr>
    <tr>
      <th>2003-01-03 00:00:00</th>
      <td>7.45</td>
      <td>21.14</td>
      <td>29.24</td>
    </tr>
    <tr>
      <th>2003-01-06 00:00:00</th>
      <td>7.45</td>
      <td>21.52</td>
      <td>29.96</td>
    </tr>
    <tr>
      <th>2003-01-07 00:00:00</th>
      <td>7.43</td>
      <td>21.93</td>
      <td>28.95</td>
    </tr>
    <tr>
      <th>2003-01-08 00:00:00</th>
      <td>7.28</td>
      <td>21.31</td>
      <td>28.83</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
type(close_px)
```




    pandas.core.frame.DataFrame


<br>
